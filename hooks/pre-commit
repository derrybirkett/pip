#!/usr/bin/env bash
# Pre-commit hook to prevent direct commits to main branch

branch="$(git rev-parse --abbrev-ref HEAD)"

if [ "$branch" = "main" ]; then
  echo ""
  echo "âŒ ERROR: Direct commits to 'main' branch are not allowed!"
  echo ""
  echo "Please use a feature branch instead:"
  echo "  git checkout -b feat/your-feature"
  echo "  # make your changes"
  echo "  git add ."
  echo "  git commit -m \"your message\""
  echo ""
  echo "See WARP.md for branching guidelines."
  echo ""
  exit 1
fi

# Run git-secrets check if available
if command -v git-secrets &> /dev/null; then
  git secrets --pre_commit_hook -- "$@"
fi

exit 0
